import{_ as s,o as a,c as e,aA as t}from"./chunks/framework.A7OkVGlh.js";const k=JSON.parse('{"title":"Plot Joint Probability","description":"","frontmatter":{},"headers":[],"relativePath":"demos/plot_joint_probability.md","filePath":"demos/plot_joint_probability.md","lastUpdated":null}'),l={name:"demos/plot_joint_probability.md"};function n(o,i,r,p,h,d){return a(),e("div",null,[...i[0]||(i[0]=[t(`<h1 id="Plot-Joint-Probability" tabindex="-1">Plot Joint Probability <a class="header-anchor" href="#Plot-Joint-Probability" aria-label="Permalink to &quot;Plot Joint Probability {#Plot-Joint-Probability}&quot;">​</a></h1><p>This demo demonstrates using joint probability analysis to detect bad channels based on multi-dimensional statistical outliers.</p><p>This demo demonstrates using joint probability analysis to detect bad channels based on multi-dimensional statistical outliers.</p><h3 id="What-is-Joint-Probability?" tabindex="-1">What is Joint Probability? <a class="header-anchor" href="#What-is-Joint-Probability?" aria-label="Permalink to &quot;What is Joint Probability? {#What-is-Joint-Probability?}&quot;">​</a></h3><p>Joint probability analysis detects outlier channels by examining how each channel&#39;s distribution relates to all other channels simultaneously:</p><ul><li><p><strong>Multi-dimensional comparison</strong>: Unlike single metrics (variance, kurtosis), joint probability considers the full distribution</p></li><li><p><strong>Statistical outlier detection</strong>: Channels that don&#39;t fit the overall pattern are flagged</p></li><li><p><strong>More sensitive</strong>: Catches unusual channels that may pass single-metric tests</p></li></ul><h3 id="How-It-Works" tabindex="-1">How It Works <a class="header-anchor" href="#How-It-Works" aria-label="Permalink to &quot;How It Works {#How-It-Works}&quot;">​</a></h3><ol><li><p><strong>Calculate channel statistics</strong>: Extract features from each channel (amplitude, variance, etc.)</p></li><li><p><strong>Build joint distribution</strong>: Model the typical pattern across all channels</p></li><li><p><strong>Compute probabilities</strong>: For each channel, calculate how likely its pattern is</p></li><li><p><strong>Identify outliers</strong>: Channels with very low probability are suspicious</p></li></ol><h3 id="Interpreting-Results" tabindex="-1">Interpreting Results <a class="header-anchor" href="#Interpreting-Results" aria-label="Permalink to &quot;Interpreting Results {#Interpreting-Results}&quot;">​</a></h3><p><strong>Low probability values</strong> (close to 0):</p><ul><li><p>Channel doesn&#39;t fit typical pattern</p></li><li><p>Potential bad channel</p></li><li><p>May have unusual artifacts or noise</p></li></ul><p><strong>Consistent probability values</strong> (similar across channels):</p><ul><li><p>Data quality is uniform</p></li><li><p>No obvious outliers</p></li></ul><p><strong>Spatial clusters</strong> of low probability:</p><ul><li><p>Systematic recording issues</p></li><li><p>Poor contact in a region</p></li><li><p>Regional artifacts</p></li></ul><h3 id="Use-Cases" tabindex="-1">Use Cases <a class="header-anchor" href="#Use-Cases" aria-label="Permalink to &quot;Use Cases {#Use-Cases}&quot;">​</a></h3><p><strong>Pre-processing quality control</strong>:</p><ul><li><p>Automated bad channel detection</p></li><li><p>Objective identification criteria</p></li><li><p>Reduces manual inspection time</p></li></ul><p><strong>Complement other metrics</strong>:</p><ul><li><p>Use with variance and kurtosis</p></li><li><p>Catches different types of artifacts</p></li><li><p>More comprehensive quality assessment</p></li></ul><p><strong>Research validation</strong>:</p><ul><li><p>Document channel exclusion decisions</p></li><li><p>Consistent criteria across datasets</p></li><li><p>Reproducible preprocessing</p></li></ul><h3 id="Threshold-Selection" tabindex="-1">Threshold Selection <a class="header-anchor" href="#Threshold-Selection" aria-label="Permalink to &quot;Threshold Selection {#Threshold-Selection}&quot;">​</a></h3><p>The default threshold identifies statistical outliers, but you may need to adjust based on:</p><ul><li><p><strong>Data quality</strong>: Noisy data may need more lenient thresholds</p></li><li><p><strong>Channel count</strong>: More channels → more statistical power</p></li><li><p><strong>Analysis goals</strong>: Conservative vs aggressive cleaning</p></li></ul><h3 id="Advantages-Over-Single-Metrics" tabindex="-1">Advantages Over Single Metrics <a class="header-anchor" href="#Advantages-Over-Single-Metrics" aria-label="Permalink to &quot;Advantages Over Single Metrics {#Advantages-Over-Single-Metrics}&quot;">​</a></h3><p><strong>Variance alone</strong>: Misses channels with unusual distributions but normal variance</p><p><strong>Kurtosis alone</strong>: Misses channels with shifted means or different scales</p><p><strong>Joint probability</strong>: Combines multiple dimensions to catch subtle issues</p><h2 id="Workflow-Summary" tabindex="-1">Workflow Summary <a class="header-anchor" href="#Workflow-Summary" aria-label="Permalink to &quot;Workflow Summary {#Workflow-Summary}&quot;">​</a></h2><p>This demo shows joint probability analysis:</p><h3 id="1.-Load-and-Preprocess" tabindex="-1">1. Load and Preprocess <a class="header-anchor" href="#1.-Load-and-Preprocess" aria-label="Permalink to &quot;1. Load and Preprocess {#1.-Load-and-Preprocess}&quot;">​</a></h3><ul><li><p>Read continuous data</p></li><li><p>Apply basic preprocessing (reference, filter)</p></li></ul><h3 id="2.-Compute-Joint-Probability" tabindex="-1">2. Compute Joint Probability <a class="header-anchor" href="#2.-Compute-Joint-Probability" aria-label="Permalink to &quot;2. Compute Joint Probability {#2.-Compute-Joint-Probability}&quot;">​</a></h3><ul><li><p>Calculate multi-dimensional statistics</p></li><li><p>Build probability distribution</p></li><li><p>Returns metrics for each channel</p></li></ul><h3 id="3.-Visualize-Results" tabindex="-1">3. Visualize Results <a class="header-anchor" href="#3.-Visualize-Results" aria-label="Permalink to &quot;3. Visualize Results {#3.-Visualize-Results}&quot;">​</a></h3><ul><li><p>Plot probability values per channel</p></li><li><p>Identify low-probability outliers</p></li><li><p>Assess spatial patterns</p></li></ul><h3 id="4.-Use-Results-for-QC" tabindex="-1">4. Use Results for QC <a class="header-anchor" href="#4.-Use-Results-for-QC" aria-label="Permalink to &quot;4. Use Results for QC {#4.-Use-Results-for-QC}&quot;">​</a></h3><ul><li><p>Flag suspicious channels</p></li><li><p>Combine with other metrics</p></li><li><p>Make informed exclusion decisions</p></li></ul><h2 id="Code-Examples" tabindex="-1">Code Examples <a class="header-anchor" href="#Code-Examples" aria-label="Permalink to &quot;Code Examples {#Code-Examples}&quot;">​</a></h2><details class="details custom-block"><summary>Show Code</summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> EegFun</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># read raw data</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dat </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> EegFun</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">read_raw_data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;./resources/data/example1.bdf&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># read and preprate layout file</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">layout_file </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> EegFun</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">read_layout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;./resources/layouts/biosemi/biosemi72.csv&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">EegFun</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">polar_to_cartesian_xy!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(layout_file)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># create EegFun data structure (EegFun.ContinuousData)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dat </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> EegFun</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">create_eeg_dataframe</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dat, layout_file);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Some minimal preprocessing (average reference and highpass filter)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">EegFun</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">rereference!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dat, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:avg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">EegFun</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">highpass_filter!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dat, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># test plot_channel_summary</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">jp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> EegFun</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">channel_joint_probability</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(dat)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">EegFun</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">plot_joint_probability</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(jp)</span></span></code></pre></div></details><h2 id="See-Also" tabindex="-1">See Also <a class="header-anchor" href="#See-Also" aria-label="Permalink to &quot;See Also {#See-Also}&quot;">​</a></h2><ul><li><a href="./../reference/">API Reference</a></li></ul>`,43)])])}const c=s(l,[["render",n]]);export{k as __pageData,c as default};
